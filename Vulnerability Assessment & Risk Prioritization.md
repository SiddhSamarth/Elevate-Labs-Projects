# Vulnerability Assessment Lab Manual

### Structured + Practical Walkthrough

This repository documents a complete **Vulnerability Assessment (VA)** workflow performed in a controlled lab environment.

The goal was not just to “run a scanner,” but to:

* Understand what the scanner is actually doing
* Interpret vulnerabilities in business context
* Map findings to CVE and CVSS
* Prioritize remediation based on risk
* Produce a professional assessment report

---

# Overview

This lab covers:

* Scope definition & authorization
* Pre-scan validation
* Scanner configuration
* Vulnerability discovery
* CVE & CVSS mapping
* Risk classification
* Remediation planning
* Vulnerable lab setup (Metasploitable-style)

---

# Lab Objectives

By completing this lab, you will be able to:

* Define assessment boundaries
* Configure enterprise-grade scanners
* Perform authenticated and unauthenticated scans
* Interpret vulnerability output
* Map findings to CVE and CVSS
* Prioritize remediation based on business risk
* Produce a professional vulnerability report

---

# Tools Used

* Nessus
* OpenVAS
* Qualys
* Nmap (pre-scan validation)

---

# Lab Environment

| Component        | Description             |
| ---------------- | ----------------------- |
| Target OS        | Windows Server / Ubuntu |
| Attacker Machine | Kali Linux              |
| Scan Type        | Internal Network Scan   |
| Scope Example    | 192.168.1.0/24          |

---

# Phase 1 – Define Scope

Before touching any scanner, define:

* Target IP range: `192.168.1.0/24`
* Critical assets:

  * Domain Controller
  * Web Server
  * Database Server
* Scan window: 10 PM – 2 AM
* Scan type: Internal authenticated scan

This prevents:

* Legal violations
* Service disruption
* IDS/IPS escalations

---

### Scope Definition Flow

```mermaid
flowchart TD
    A[Start] --> B[Identify IP Range]
    B --> C[Identify Critical Assets]
    C --> D[Define Exclusions]
    D --> E[Set Scan Window]
    E --> F[Obtain Authorization]
    F --> G[Proceed to Configuration]
```

---

# Phase 2 – Pre-Scan Validation (Nmap)

Before launching the vulnerability scanner:

```bash
nmap -sS -sV 192.168.1.10
```

Purpose:

* Validate live hosts
* Identify open ports
* Detect running services
* Confirm expected exposure

---

## Example: Nmap Output

![Image](https://www.varonis.com/hubfs/Imported_Blog_Media/nmap-top-screenshot.jpg?hsLang=en)

![Image](https://www.cyberciti.biz/media/new/cms/2012/11/welcome-nmap.png)

![Image](https://nmap.org/book/images/zenmap-fig-tab-nmap-output.png)

![Image](https://www.cyberciti.biz/media/new/cms/2012/11/nmap-usage-examples-output.png)

What to observe:

* Is SMB (445) open?
* Outdated Apache?
* Unnecessary services exposed?

---

# Phase 3 – Scanner Configuration

Using **Nessus** as example.

## Configuration Checklist

| Setting     | Recommended           |
| ----------- | --------------------- |
| Scan Type   | Advanced Network Scan |
| Port Range  | 1–65535               |
| Credentials | Enabled               |
| Safe Checks | Enabled               |
| Max Hosts   | Limited               |

---

## Credentialed vs Unauthenticated

| Type            | Visibility                    |
| --------------- | ----------------------------- |
| Unauthenticated | Surface-level detection       |
| Credentialed    | Patch level + local misconfig |

Credentialed scans detect:

* Missing patches
* Weak registry settings
* Local privilege escalation
* Configuration drift

---

## Example: Scanner Configuration

![Image](https://docs.tenable.com/nessus/10_8/Content/Images/Scans8.4Later.png)

![Image](https://www.4armed.com/uploads/2016/09/2-1.png)

![Image](https://www.tenable.com/sites/drupal.dmz.tenablesecurity.com/files/images/blog/HostDiscCustom.png)

![Image](https://www.tenable.com/sites/drupal.dmz.tenablesecurity.com/files/images/blog/ScanOptsPage.png)

---

### Scanner Configuration Flow

```mermaid
flowchart TD
    A[Create New Scan] --> B[Select Scan Template]
    B --> C[Configure Ports]
    C --> D[Add Credentials]
    D --> E[Enable Safe Checks]
    E --> F[Save Profile]
```

---

# Phase 4 – Execute Scan

Scanner workflow:

1. Host Discovery
2. Port Scanning
3. Service Enumeration
4. Vulnerability Matching
5. Severity Assignment

---

## Example: Scan Dashboard

![Image](https://www.tenable.com/sites/default/files/images/sc-dashboards/Vulns_Over_30_Days_Dashboard.png)

![Image](https://www.tenable.com/sites/default/files/images/sc-dashboards/VPRSummary-final-Updated6Feb2019.png)

![Image](https://www.tenable.com/sites/default/files/images/sc-dashboards/VulnTopTen_revg.png)

![Image](https://s3.amazonaws.com/a-us.storyblok.com/f/1022730/13eb6d6425/screenshot-monitor-open-source-vulnerabilities-dashboard.png)

Monitor:

* CPU utilization
* Network spikes
* Service responsiveness

---

### Scan Execution Flow

```mermaid
flowchart TD
    A[Start Scan] --> B[Host Discovery]
    B --> C[Port Scan]
    C --> D[Service Enumeration]
    D --> E[Vulnerability Detection]
    E --> F[Generate Results]
```

---

# Phase 5 – Review Findings

Severity Levels:

| Severity | CVSS      |
| -------- | --------- |
| Critical | 9.0 – 10  |
| High     | 7.0 – 8.9 |
| Medium   | 4.0 – 6.9 |
| Low      | 0.1 – 3.9 |

Example findings:

```
Critical: Remote Code Execution
High: SMBv1 Enabled
Medium: TLS 1.0 Enabled
Low: Missing Security Headers
```

---

## Example: Vulnerability Detail Page

![Image](https://www.tenable.com/sites/drupal.dmz.tenablesecurity.com/files/images/blog/How%20To-%20Run%20Your%20First%20Vulnerability%20Scan%20with%20Nessus_4.png)

![Image](https://www.tenable.com/sites/default/files/images/sc-dashboards/CVSS%20Exploitability%20%28E%29%20and%20Remediation%20Level%20%28RL%29%20Risk%20Matrices_rev.png)

![Image](https://pentest-tools.com/images/reports/website-scanner/powerful-website-scanner-report.webp)

![Image](https://www.roboshadow.com/hs-fs/hubfs/Glass%20Website%20Panel%201.png?name=Glass+Website+Panel+1.png\&width=950)

CVE database maintained by:

* MITRE Corporation

---

# Phase 6 – Risk Classification

Risk ≠ Severity.

Risk formula:

```
Risk = Likelihood × Impact
```

Example:

| Vulnerability | CVSS | Asset             | Final Risk |
| ------------- | ---- | ----------------- | ---------- |
| SMBv1         | 8.8  | Domain Controller | Critical   |
| Weak Cipher   | 5.3  | Dev Server        | Low        |

---

### Risk Evaluation Flow

```mermaid
flowchart TD
    A[Vulnerability Found] --> B[Identify CVE]
    B --> C[Review CVSS]
    C --> D[Assess Asset Criticality]
    D --> E[Calculate Risk]
    E --> F[Assign Priority]
```

---

# Phase 7 – Remediation Strategy

## Patch Management

* Apply vendor updates
* Upgrade vulnerable components

## Configuration Hardening

* Disable SMBv1
* Disable TLS 1.0
* Remove unused services

## Access Controls

* Enforce MFA
* Remove excessive admin privileges

## Compensating Controls

* Firewall restrictions
* Network segmentation
* IDS/IPS monitoring

---

### Remediation Workflow

```mermaid
flowchart TD
    A[Critical Finding] --> B{Patch Available?}
    B -->|Yes| C[Apply Patch]
    B -->|No| D[Apply Compensating Control]
    C --> E[Rescan]
    D --> E
    E --> F[Close Finding]
```

---

# Vulnerable Lab Setup (Metasploitable-Style)

To practice safely, create an isolated vulnerable environment.

Never expose vulnerable machines to the internet.

---

## Required Components

* VirtualBox
* Kali Linux
* Metasploitable 2
* Damn Vulnerable Web Application

---

## Network Architecture

```
        [ Kali Linux ]
              |
      ------------------
      | Internal Net   |
      ------------------
              |
       [ Metasploitable ]
```

Use:

* Internal Network only
* No NAT
* No Bridged adapter

---

### Lab Architecture Flow

```mermaid
flowchart TD
    A[Host Machine] --> B[VirtualBox Internal Network]
    B --> C[Kali Linux]
    B --> D[Metasploitable]
```

---

## Deploy Metasploitable

Default credentials:

```
Username: msfadmin
Password: msfadmin
```

Verify IP:

```bash
ifconfig
```

From Kali:

```bash
ping <target-ip>
```

---

## Scan the Vulnerable Machine

```bash
nmap -sS -sV <target-ip>
```

Expected exposed services:

* FTP
* Telnet
* SMB
* Apache
* MySQL
* Tomcat

---

## Example: Metasploitable Scan

![Image](https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2021/05/Portscan.PNG)

![Image](https://www.cm-alliance.com/hs-fs/hubfs/Metasploit-1.webp?height=444\&name=Metasploit-1.webp\&width=700)

![Image](https://docs.rapid7.com/images/metasploit/phpinfo.png)

![Image](https://docs.rapid7.com/images/metasploit/metasploitable-web-home-page.png)

Then run:

* Nessus
* OpenVAS

Observe large number of CVEs and outdated services.

---

# Final Report Structure

1. Executive Summary
2. Scope
3. Methodology
4. Tools Used
5. Risk Rating Model
6. Detailed Findings
7. Remediation Plan
8. CVE Appendix

---

# Vulnerability Assessment vs Penetration Testing

| Vulnerability Assessment | Penetration Testing     |
| ------------------------ | ----------------------- |
| Identifies weaknesses    | Exploits weaknesses     |
| Mostly automated         | Manual + automated      |
| Risk prioritization      | Proof-of-concept attack |
| Defensive focus          | Offensive validation    |

---

# Lab Completion Criteria

* Scan successfully executed
* CVE mapped
* CVSS interpreted
* Risk classified
* Remediation documented
* Final report generated

---

# Key Takeaway

Vulnerability assessment is not about pressing “Scan.”

It is about:

* Understanding exposure
* Evaluating business impact
* Prioritizing intelligently
* Communicating clearly
